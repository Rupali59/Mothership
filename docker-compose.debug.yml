# =============================================================================
# Debug Override - Volume mounts + inspect/Delve ports
# =============================================================================
# Use with: docker compose -f docker-compose.dev.yml -f docker-compose.debug.yml up
#
# - Mounts local source for frontend, jhora, vedika (live code sync)
# - Exposes Node.js --inspect ports (9230, 9231, 9232)
# - Exposes Delve ports for Go services (2345-2362)
# - Sets ENABLE_DEBUG=1 so supervisord-debug.conf is used
# =============================================================================

services:
  motherboard:
    ports:
      - "9230:9230"  # frontend inspect
      - "9231:9231"  # jhora inspect
      - "9232:9232"  # vedika inspect
      - "2345:2345"  # backend delve
      - "2346:2346"  # auth delve
      - "2347:2347"  # health delve
      - "2348:2348"  # billing delve
      - "2349:2349"  # entitlement delve
      - "2350:2350"  # notification delve
      - "2351:2351"  # storage delve
      - "2352:2352"  # cloud-adapter delve
      - "2353:2353"  # marketing delve
      - "2354:2354"  # scheduler delve
      - "2355:2355"  # inventory delve
      - "2356:2356"  # orders delve
      - "2357:2357"  # email delve
      - "2358:2358"  # sms delve
      - "2359:2359"  # whatsapp delve
      - "2360:2360"  # telegram delve
      - "2361:2361"  # razorpay delve
      - "2362:2362"  # stripe delve
    volumes:
      - ./.env.monolith:/app/.env.monolith
      - ./apps/motherboard/frontend:/app/frontend
      - frontend_node_modules:/app/frontend/node_modules
      - ./plugins/jhora:/app/jhora
      - ./plugins/vedika:/app/vedika
    environment:
      - ENABLE_DEBUG=1

volumes:
  frontend_node_modules:
    driver: local
